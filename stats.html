<!DOCTYPE html>
<html>

<head>
<script src = https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.js></script>
</head>

<body>
<p>
    Add/update a user to the database:
</p>
<form action='/adduser'>
  <input type="text" placeholder="Username.." name="username">
  <input type="submit" value="submit">
</form>
<p>
    Remove a user from the database:
</p>
<form action='/removeuser'>
  <input type="text" placeholder="Username.." name="username">
  <input type="submit" value="submit">
</form>
<p>
    Reset the database and return home:
</p>
<form action='/'>
  <input type="submit" value="reset">
</form>

<script>
    var data = {{data}};
    var max = data.max;
    var stats = data.stats;

    for(var i = 0; i < stats.length; i++) {
      var language = stats[i];

      var myChart = document.createElement('canvas');
      myChart.id = language.name;
      myChart.width = 250;
      myChart.height = 250;
      document.body.appendChild(myChart);

      var config = {
  			type: 'pie',
  			data: {
  				datasets: [
            {
    					data: [language.avg_commits, language.generic_commits],
    					backgroundColor: ['#42d4f4', '#4363d8'],
    					label: 'Commits'
            },
            {
    					data: [language.avg_branches, language.generic_branches],
    					backgroundColor: ['#bfef45', '#3cb44b'],
    					label: 'Branches'
            },
            {
    					data: [language.avg_contributors, language.generic_contributors],
    					backgroundColor: ['#e6194B', '#800000'],
    					label: 'Contributors'
            },
            {
    					data: [language.avg_size, language.generic_size],
    					backgroundColor: ['#f58231', '#ffe119'],
    					label: 'Size'
  				  }
          ],
  				labels: ['User', 'Average']
  			},
  			options: {
          title: {
            display: true,
            text: language.name
          },
          legend: {
            display: false
          },
          tooltips: {
            callbacks: {
              title: function(tooltipItems, data) {
                return data.datasets[tooltipItems[0].datasetIndex].label;
              }
      			}
      		},
  				responsive: false
  			}
  		};

      var ctx = document.getElementById(language.name).getContext('2d');
			window.myPie = new Chart(ctx, config);
    }
</script>

</body>
</html>
